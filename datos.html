<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Datos de Recibos - Lavander铆a JC</title>
  <link rel="icon" type="image/png" href="imagenes/favicon.png" />
  <link rel="stylesheet" href="datos.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="contenedor-datos">
    <h2>Recibos Guardados</h2>

    <div class="filtros">
      <label>Desde: <input type="date" id="filtroDesde"></label>
      <label>Hasta: <input type="date" id="filtroHasta"></label>
      <button onclick="mostrarRecibos()">Aplicar Filtro</button>
      <button style="background-color: red; color: white; margin-top: 10px;" onclick="eliminarFiltrados()">Eliminar Filtrados</button>
    </div>    

    <div class="gasto-form">
      <h3>Registrar Gasto</h3>
      <input type="date" id="fechaGasto" required />
      <input type="text" id="descripcionGasto" placeholder="Descripci贸n" required />
      <input type="number" id="montoGasto" placeholder="Monto ($)" required />
      <select id="categoriaGasto" required>
        <option value="" disabled selected>Selecciona categor铆a</option>
        <option value="insumos">Insumos</option>
        <option value="otros">Gastos</option>
        <option value="otros">Otros</option>
      </select>
      <button onclick="registrarGasto()">Agregar Gasto</button>
    </div>

    <div id="lista-recibos"></div>
    <div id="total-ganancias">Total: $0</div>
    <canvas id="graficaGanancias" width="400" height="200"></canvas>

    <button class="ver-datos" onclick="exportarAExcel()">Descargar Excel</button>
    <button class="volver" onclick="window.location.href='recibos.html'">Volver a Recibos</button>
    <button class="volver" onclick="window.location.href='analisis.html'">Analisis Avanzado</button>
    <button class="volver" onclick="window.location.href='index.html'">Regresar a Inicio</button>
    <button class="volver1" onclick="window.location.href='regisropa.html'">Registro de ropa</button>
  </div>

  <!--  Bot贸n flotante para ir hasta abajo -->
  <button id="btnIrAbajo" onclick="irAbajo()">猬锔</button>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-database-compat.js"></script>

  <!-- SheetJS para exportar a Excel -->
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

  <script src="datos.js"></script>

  <div id="modalEditarRecibo" style="display: none;" class="modal">
    <div class="modal-content">
      <h3>Editar Recibo</h3>
      <label>Nombre del Cliente:</label>
      <input type="text" id="modalNuevoCliente"><br>

      <label>Fecha de Ingreso:</label>
      <input type="date" id="modalNuevaFechaIngreso"><br>

      <label>Fecha de Entrega:</label>
      <input type="date" id="modalNuevaFechaEntrega"><br>

      <label>Total ($):</label>
      <input type="number" id="modalNuevoTotal" step="0.01"><br>

      <button id="btnGuardarCambios">Guardar Cambios</button>
      <button onclick="document.getElementById('modalEditarRecibo').style.display='none'">Cancelar</button>
    </div>
  </div>

  <!-- Script del bot贸n -->
  <script>
    function irAbajo() {
      window.scrollTo({
        top: document.body.scrollHeight,
        behavior: 'smooth'
      });
    }

    // Mostrar el bot贸n solo cuando haya que desplazarse
    window.addEventListener('scroll', function() {
      const btn = document.getElementById('btnIrAbajo');
      if (window.scrollY < 200) {
        btn.style.opacity = '1';
      } else {
        btn.style.opacity = '0.7';
      }
    });
  </script>
</body>
</html>
